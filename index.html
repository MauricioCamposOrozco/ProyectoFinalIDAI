<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clover Multicaps - Gorras</title>
  <link rel="stylesheet" href="style-index.css">
</head>
<body>

<header>
  <h1>Clover Multicaps</h1>
  <p style="margin-top: 10px; font-size: 18px; color: #ccc;">Tu estilo, nuestra inspiración.</p>
  <nav>
    <ul>
      <li><a href="index.html">Inicio</a></li>
      <li><a href="Catalogo.html">Catálogo</a></li>
      <li><a href="Información.html">Información</a></li>
    </ul>
  </nav>
</header>

<main>
  <section class="presentacion">
    <h2>Bienvenido a Clover Multicaps</h2>
    <p>En Clover Multicaps creemos que una gorra es más que un accesorio: es parte de tu estilo.</p>
  </section>

  <section class="productos">
    <h2>Nuestras gorras más populares</h2>
    <div class="producto-lista">

      <div class="producto" data-precio="2099" data-stock="5">
        <img src="imagenes-proyecto/gorra alo.webp" alt="Gorra alo Negra">
        <h3>Gorra alo Negra</h3>
        <p>Un diseño básico y elegante para cualquier ocasión.</p>
      </div>

      <div class="producto" data-precio="1499" data-stock="8">
        <img src="imagenes-proyecto/gorra mago dandy.jpg" alt="Gorra dandy mago">
        <h3>Gorra dandy "mago"</h3>
        <p>Buen diseño y materiales de calidad</p>
      </div>

      <div class="producto" data-precio="1499" data-stock="6">
        <img src="imagenes-proyecto/sad boyz gorra.jpg" alt="Gorra sad boyz">
        <h3>Gorra dandy "sad boyz"</h3>
        <p>Un modelo moderno con estilo urbano</p>
      </div>

      <div class="producto" data-precio="1499" data-stock="4">
        <img src="imagenes-proyecto/Canelo gorra.webp" alt="Gorra dandy del Canelo">
        <h3>Gorra dandy del Canelo</h3>
        <p>Colaboración con el boxeador mexicano.</p>
      </div>

      <div class="producto" data-precio="1699" data-stock="7">
        <img src="imagenes-proyecto/Gorra del nata.webp" alt="Gorra de Natanael Cano">
        <h3>Gorra de Natanael Cano</h3>
        <p>Inspirada en el famoso cantante mexicano Natanael Cano</p>
      </div>

      <div class="producto" data-precio="3000" data-stock="3">
        <img src="imagenes-proyecto/Gorra CHROME CT.webp" alt="Gorra Chrome">
        <h3>Gorra Chrome</h3>
        <p>Diseño impecable y llamativo</p>
      </div>

    </div>
  </section>
</main>

<!-- Modal -->
<div id="modalProducto" class="modal">
  <div class="modal-contenido">
    <button class="cerrar" id="cerrarModalBtn">&times;</button>
    <div class="modal-body">
      <img id="modalImagen" src="" alt="Producto">
      <div class="modal-info">
        <h2 id="modalNombre"></h2>
        <p id="modalDescripcion"></p>
        <p class="modal-precio">Precio: <span id="modalPrecio"></span></p>
        <p id="modalStock"></p>
        <div class="modal-acciones">
          <!-- min="1" y step="1" para ayudar al navegador a restringir valores -->
          <input type="number" id="cantidad" value="1" min="1" step="1">
          <button id="btnAgregar">Agregar al Carrito</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Recibo -->
<div id="recibo" class="recibo oculto">
  <h3>Recibo</h3>
  <ul id="rLista"></ul>
  <p class="recibo-total"><strong>Total:</strong> <span id="rTotal">$0.00</span></p>

  <!-- Nuevo campo para el nombre del cliente -->
  <input type="text" id="nombre" placeholder="Tu nombre">

  <input type="tel" id="telefono" placeholder="Número telefónico">
  <button id="enviarBtn">Enviar recibo</button>
  <button id="vaciarBtn" class="vaciar">Vaciar carrito</button>
</div>

  <footer class="footer">
    <div class="footer-contenedor">

     <div class="footer-info">
      <ul>
        <li><a href="PreguntasFrecuentes.html">Preguntas Frecuentes</a></li>
        <li><a href="Devoluciones.html">Políticas de Devolución</a></li>
      </ul>
      </div>

      <div class="footer-redes">
        <h4>SÍGUENOS</h4>
        <div class="iconos">
          <a href="https://www.facebook.com/profile.php?id=100114776131599" target="_blank" rel="noopener">
            <img src="https://cdn-icons-png.flaticon.com/24/145/145802.png" width="30" alt="Facebook">
          </a>

          <a href="https://www.instagram.com/clover_multicaps4/" target="_blank" rel="noopener">
            <img src="https://cdn-icons-png.flaticon.com/24/2111/2111463.png" width="30" alt="Instagram">
          </a>

          <a href="https://www.tiktok.com/@clover.multicaps"><img src="https://cdn-icons-png.flaticon.com/24/3046/3046124.png" width="30" alt="Otra red"></a>
        </div>
      </div>

  </footer>

<script>
// --- Variables ---
var carrito = [];
var productos = document.querySelectorAll('.producto');
var modal = document.getElementById('modalProducto');
var modalImagen = document.getElementById('modalImagen');
var modalNombre = document.getElementById('modalNombre');
var modalDescripcion = document.getElementById('modalDescripcion');
var modalPrecio = document.getElementById('modalPrecio');
var modalStock = document.getElementById('modalStock');
var cantidadEl = document.getElementById('cantidad');
var btnAgregar = document.getElementById('btnAgregar');
var cerrarModalBtn = document.getElementById('cerrarModalBtn');
var rLista = document.getElementById('rLista');
var rTotal = document.getElementById('rTotal');
var reciboEl = document.getElementById('recibo');

// --- Inicializar inventario ---
for(var i=0; i<productos.length; i++){
  var stock = Number(productos[i].dataset.stock);
  var badge = document.createElement('span');
  badge.className = 'stock-badge';
  badge.id = 'stock-badge-' + i;
  badge.innerText = stock > 0 ? 'Stock: '+stock : 'Agotado';
  productos[i].appendChild(badge);
}

// --- Abrir modal ---
for(var i=0; i<productos.length; i++){
  productos[i].dataset.index = i;
  productos[i].onclick = function(){
    var idx = this.dataset.index;
    var prod = productos[idx];
    modalImagen.src = prod.querySelector('img').src;
    modalNombre.innerText = prod.querySelector('h3').innerText;
    modalDescripcion.innerText = prod.querySelector('p').innerText;
    modalPrecio.innerText = '$' + Number(prod.dataset.precio).toFixed(2);
    cantidadEl.value = 1;
    modalStock.innerText = 'Disponible: ' + prod.dataset.stock;
    btnAgregar.disabled = Number(prod.dataset.stock) === 0;
    modal.dataset.index = idx;
    modal.style.display = 'flex';
  }
}

// --- Cerrar modal ---
cerrarModalBtn.onclick = function(){ modal.style.display = 'none'; }
window.onclick = function(e){ if(e.target==modal) modal.style.display='none'; }
window.onkeydown = function(e){ if(e.key==='Escape') modal.style.display='none'; }

// --- Prevención en tiempo real: no permitir 0 ni negativos ni decimales ---
cantidadEl.addEventListener('input', function(){
  // convertir a entero
  var val = parseInt(this.value, 10);
  if(isNaN(val) || val < 1){
    // si escriben 0, negativo o nada, lo corregimos a 1 sin spam de alert
    this.value = 1;
  } else {
    // mantener solo la parte entera (evita decimales)
    this.value = Math.floor(val);
  }
});

// --- Agregar al carrito ---
btnAgregar.onclick = function(){
  var idx = modal.dataset.index;
  var prod = productos[idx];
  var stock = Number(prod.dataset.stock);

  // validar cantidad: entero y >= 1
  var cantidad = Number(cantidadEl.value);
  if(!Number.isFinite(cantidad) || !Number.isInteger(cantidad) || cantidad < 1){
    alert('La cantidad debe ser un número entero y al menos 1');
    cantidadEl.value = 1;
    return;
  }

  if(cantidad > stock){
    alert('No hay suficiente stock');
    return;
  }

  var existe = carrito.find(function(item){ return item.idx==idx; });
  if(existe){
    existe.cantidad += cantidad;
  } else {
    carrito.push({idx: idx, nombre: prod.querySelector('h3').innerText, cantidad: cantidad, precio: Number(prod.dataset.precio)});
  }

  prod.dataset.stock = stock - cantidad;
  document.getElementById('stock-badge-'+idx).innerText = prod.dataset.stock>0 ? 'Stock: '+prod.dataset.stock : 'Agotado';
  actualizarRecibo();
  modal.style.display='none';
  console.log('Carrito:', carrito);
}

// --- Actualizar recibo ---
function actualizarRecibo(){
  rLista.innerHTML = '';
  var total = 0;
  for(var i=0; i<carrito.length; i++){
    var it = carrito[i];
    var subtotal = it.cantidad * it.precio;
    total += subtotal;
    var li = document.createElement('li');
    li.innerText = it.cantidad + ' x ' + it.nombre + ' = $' + subtotal.toFixed(2);
    rLista.appendChild(li);
  }
  rTotal.innerText = '$'+total.toFixed(2);
  reciboEl.style.display = carrito.length>0 ? 'block' : 'none';
}

// --- Vaciar carrito ---
document.getElementById('vaciarBtn').onclick = function(){
  for(var i=0; i<carrito.length; i++){
    var it = carrito[i];
    productos[it.idx].dataset.stock = Number(productos[it.idx].dataset.stock) + it.cantidad;
    document.getElementById('stock-badge-'+it.idx).innerText = 'Stock: '+productos[it.idx].dataset.stock;
  }
  carrito = [];
  actualizarRecibo();
}

// --- Enviar WhatsApp ---
document.getElementById('enviarBtn').onclick = function(){
  var tel = document.getElementById('telefono').value.replace(/\D/g,'');
  var nombre = document.getElementById('nombre').value.trim();

  if(nombre.length === 0){ alert('Ingresa tu nombre'); return; }
  if(tel.length<10){ alert('Número inválido'); return; }
  if(carrito.length===0){ alert('Carrito vacío'); return; }

  var mensaje = 'Recibo Clover Multicaps\n';
  mensaje += 'Nombre: ' + nombre + '\n\n';

  var total = 0;
  for(var i=0; i<carrito.length; i++){
    var it = carrito[i];
    var subtotal = it.cantidad * it.precio;
    total += subtotal;
    mensaje += it.cantidad+' x '+it.nombre+' = $'+subtotal.toFixed(2)+'\n';
  }
  mensaje += '\nTotal: $'+total.toFixed(2)+'\n\n';
  mensaje += '¡Gracias por tu compra!\n';
  mensaje += 'RECOGE TU PEDIDO EN LA TIENDA EN FISICO';

  window.open('https://wa.me/52'+tel+'?text='+encodeURIComponent(mensaje),'_blank');
}
</script>

</body>
</html>
